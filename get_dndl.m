function [n,n1,n2,n3]=get_dndl(l,A1,A2,A3,l1,l2,l3)
    n = sqrt(1 + (A1 * l.^2) / (l.^2 - l1) + ...
                 (A2 * l.^2) / (l.^2 - l2) + ...
                 (A3 * l.^2) / (l.^2 - l3));
    n1 = (l .* (-1) .* (A1.*l1./(l.^2-l1).^2+A2.*l2./(l.^2-l2).^2+A3.*l3./(l.^2-l3).^2)) ./ n;
    n2 = (-10.*A1.*l.^2./(l.^2-l1).^2 + 2.*A1./(l.^2-l1) + 8.*A1.*l.^4./(l.^2-l1).^3 + ...
          -10.*A2.*l.^2./(l.^2-l2).^2 + 2.*A2./(l.^2-l2) + 8.*A2.*l.^4./(l.^2-l2).^3 + ...
          -10.*A3.*l.^2./(l.^2-l3).^2 + 2.*A3./(l.^2-l3) + 8.*A3.*l.^4./(l.^2-l3).^3)./(2.*n) - ...
          (2.*A1.*l./(l.^2-l1) - 2.*A1.*l.^3./(l.^2-l1).^2 + ...
           2.*A2.*l./(l.^2-l2) - 2.*A2.*l.^3./(l.^2-l2).^2 + ...
           2.*A3.*l./(l.^2-l3) - 2.*A3.*l.^3./(l.^2-l3).^2)./(4.*n.^3);
    n3 = 3.*(2.*A1.*l./(l.^2-l1) - 2.*A1.*l.^3./(l.^2-l1).^2 + ...
            2.*A2.*l./(l.^2-l2) - 2.*A2.*l.^3./(l.^2-l2).^2 + ...
            2.*A3.*l./(l.^2-l3) - 2.*A3.*l.^3./(l.^2-l3).^2).^3./(8.*n.^5) + ...
            (-24.*A1.*l./(l.^2-l1).^2 - 48.*A1.*l.^5./(l.^2-l1).^4 + 72.*A1.*l.^3./(l.^2-l1).^3 - ...
              24.*A2.*l./(l.^2-l2).^2 - 48.*A2.*l.^5./(l.^2-l2).^4 + 72.*A2.*l.^3./(l.^2-l2).^3 - ...
              24.*A3.*l./(l.^2-l3).^2 - 48.*A3.*l.^5./(l.^2-l3).^4 + 72.*A3.*l.^3./(l.^2-l3).^3)./(2.*n) - ...
              3.*(-10.*A1.*l.^2./(l.^2-l1).^2 + 2.*A1./(l.^2-l1) + 8.*A1.*l.^4./(l.^2-l1).^3 - ...
                  10.*A2.*l.^2./(l.^2-l2).^2 + 2.*A2./(l.^2-l2) + 8.*A2.*l.^4./(l.^2-l2).^3 - ...
                  10.*A3.*l.^2./(l.^2-l3).^2 + 2.*A3./(l.^2-l3) + 8.*A3.*l.^4./(l.^2-l3).^3) .* ...
                  (2.*A1.*l./(l.^2-l1) - 2.*A1.*l.^3./(l.^2-l1).^2 + ...
                   2.*A2.*l./(l.^2-l2) - 2.*A2.*l.^3./(l.^2-l2).^2 + ...
                   2.*A3.*l./(l.^2-l3) - 2.*A3.*l.^3./(l.^2-l3).^2)./(4.*n^3);
 end